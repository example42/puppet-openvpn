# File Managed by Puppet

<% if @remote.is_a? Array -%>
<% @remote.each do |a_remote| -%>
remote <%= a_remote %> <%= @port %>
<% end -%>
<% else -%>
remote <%= @remote %> <%= @port %>
<% end -%>
proto <%= @real_proto %>
dev <%= @dev %>
<% if @route != '' %>route <%= @route %><% end -%>
resolv-retry infinite
nobind

persist-key
persist-tun
<% if @auth_type == "key" -%>
client
secret <%= scope.lookupvar("openvpn::config_dir") %>/<%= @name %>.key
<% end -%>
<% if @auth_type == "tls-client" -%>
tls-client
ca ca.crt
cert <%= @hostname %>.crt
key <%= @hostname %>.key
pull
<% end -%>

ns-cert-type server
verb 3
;mute 20
user <%= scope.lookupvar("openvpn::process_user") %>
group <%= scope.lookupvar("openvpn::process_group") %>

<% if @bool_compress -%>
comp-lzo
<% end -%>
<% if @bool_keepalive -%>
keepalive <%= @keepalive_freq %> <%= @keepalive_timeout %>
<% end -%>
inactive 0
# cipher x
# client-connect /etc/openvpn/script/client_connect
# client-disconnect /etc/openvpn/script/client_disconnect
